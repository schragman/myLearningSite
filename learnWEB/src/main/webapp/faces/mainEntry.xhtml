<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition
	template="/page/page.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:tc="http://myfaces.apache.org/tobago/component"
  	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
		xmlns:p="http://primefaces.org/ui"
  	xmlns:h="http://xmlns.jcp.org/jsf/html">


<!--
			-->

	<f:metadata>
		<f:event type="preRenderView" listener="#{mainEntryForm.doCreateMenu}" />
	</f:metadata>

	<ui:define name="appContent">

    <tc:script file="#{request.contextPath}/tinymce/js/tinymce/tinymce.min.js" />
    <tc:script file="#{request.contextPath}/scripts/tinyinit.js" />
    <tc:script file="#{request.contextPath}/scripts/autosave.js" />
		<!--<h:form>
		<p:poll interval="3" update="newEntry" />-->
		<tc:box id="newEntry" label="#{mainEntryForm.neu?appMsg.newEntry:mainEntryForm.kBeschreibung}">
			<tc:link id="showAutosave" label="" actionListener="#{mainEntryForm.doAutosave}" />
			<tc:out id="counter" value="#{mainEntryForm.javaScriptCounter}"/>
			<ui:include src="/faces/subviews/sessionTimeOut.xhtml" />
			<tc:in id="shortDescr1" labelLayout="top" label="#{appMsg.shortDescription}"
				value="#{mainEntryForm.kBeschreibung}"
				focus="true"
				required="true"
				rendered="#{!mainEntryForm.neu and mainEntryForm.bearbeiten}">
				<!--disabled="#{!mainEntryForm.bearbeiten}">-->
			</tc:in>
			<tc:in id="shortDescr2" labelLayout="top" label="#{appMsg.shortDescription}"
					value="#{mainEntryForm.kBeschreibung}"
					focus="true"
					required="true"
					rendered="#{mainEntryForm.neu}">
				<tc:suggest query="#{mainEntryForm.kBeschreibung}" filter="prefix"
					maximumItems="3">
					<tc:selectItems value="#{mainEntryForm.alleBeschreibungen}" var="beschreibung" itemValue="#{beschreibung}"/>
				</tc:suggest>
			</tc:in>
			<tc:textarea labelLayout="top" label="#{appMsg.longDescription}"
				  id="lngDescription"
					markup="wysiwyg"
					disabled="#{!mainEntryForm.neu and !mainEntryForm.bearbeiten}"
					rows="#{configurationForm.nbDescrLines}"
					value="#{mainEntryForm.lBeschreibung}" >
			</tc:textarea>

			<tc:sheet
				id="Referenzliste"
				rendered="#{mainEntryForm.refListFilled}"
				columns="200px;300px;300px;10px"
				value="#{mainEntryForm.referenzen}"
				var="refItem">
				<tc:column label="#{appMsg.headlineType}">
					<tc:out value="#{refItem.art?'Printmedium':'Internetquelle'}"/>
				</tc:column>
				<tc:column label="#{appMsg.headlineRef}">
					<tc:out value="#{refItem.uRefferenz1}" />
				</tc:column>
				<tc:column label="#{appMsg.headlineURef}">
					<tc:out value="#{refItem.uRefferenz2}" />
				</tc:column>
				<tc:column>
					<tc:link label="-" rendered="#{mainEntryForm.neu or mainEntryForm.bearbeiten}"
						actionListener="#{mainEntryForm.removeReference(refItem)}" />
				</tc:column>
			</tc:sheet>

			<tc:flexLayout rendered="#{mainEntryForm.neu or mainEntryForm.bearbeiten}"
				columns="200px 300px 300px 20px">
				<tc:selectOneRadio id="mediaKind"
					value="#{mainEntryForm.selectedElement}">
					<tc:selectItem itemLabel="#{appMsg.book}" itemValue="book" />
					<tc:selectItem itemLabel="#{appMsg.internet}" itemValue="internet" />
					<f:ajax render="newEntry" execute="newEntry"/>
				</tc:selectOneRadio>
				<tc:in id="medium" labelLayout="top" label="#{mainEntryForm.labelReferenz}"
					value="#{mainEntryForm.referenz}">
					<tc:suggest query="#{mainEntryForm.userInput}" filter="prefix"
				  	maximumItems="3" minimumCharacters="3">
				  	<tc:selectItems value="#{mainEntryForm.alleReferenzen}" var="name" itemValue="#{name.uRefferenz1}"/>
			  	</tc:suggest>
		  	</tc:in>
				<tc:in id="uMedium" labelLayout="top" label="#{mainEntryForm.labelUReferenz}"
					value="#{mainEntryForm.uReferenz}" />
				<tc:link label="+"
						actionListener="#{mainEntryForm.addReference}">
<!-- 					<f:ajax render="newEntry" execute="mediaKind medium uMedium"/> -->
				</tc:link>
			</tc:flexLayout>

			<tc:flexLayout columns="Auto" rows="300px">
				<tc:textarea labelLayout="top" label="#{appMsg.example}"
					disabled="#{!mainEntryForm.neu and !mainEntryForm.bearbeiten}"
					rows="#{configurationForm.nbSampleLines}"
				  markup="wysiwyg"
				 	value="#{mainEntryForm.beispiel}"/>
			</tc:flexLayout>

 			<tc:sheet
				rendered="#{mainEntryForm.checkListFilled and (mainEntryForm.neu or mainEntryForm.bearbeiten)}"
				id="Abfliste"
				columns="400px;400px;10px"
				value="#{mainEntryForm.abfragen}"
				var="abfItem">
				<tc:column label="#{appMsg.question}">
					<tc:out  value="#{abfItem.frage}" />
				</tc:column>
				<tc:column label="#{appMsg.answer}">
					<tc:out value="#{abfItem.firstAntwort}" />
				</tc:column>
				<tc:column>
					<tc:link label="-"
						actionListener="#{mainEntryForm.removeAbfrage(abfItem)}" />
				</tc:column>
			</tc:sheet>

			<tc:flexLayout columns="400px 400px 20px"
				rendered="#{mainEntryForm.neu or mainEntryForm.bearbeiten}">
				<tc:in labelLayout="top" label="#{appMsg.question}"
					value="#{mainEntryForm.frage}" />
				<tc:in labelLayout="top" label="#{appMsg.answer}"
					value="#{mainEntryForm.antwort}" />
				<tc:link label="+"
					actionListener="#{mainEntryForm.addAbfrage}" />
			</tc:flexLayout>

		</tc:box>
		<!--</h:form>-->
	</ui:define>

	<ui:define name="pageButtons">
		<tc:button label="#{appMsg.save}" rendered="#{mainEntryForm.neu}" action="#{mainEntryForm.doCreateNewEntry}" />
		<tc:button label="#{appMsg.save}"
			rendered="#{!mainEntryForm.neu and mainEntryForm.bearbeiten}"
			action="#{mainEntryForm.doUpdateEntry}" />
		<tc:button label="#{appMsg.edit}"
			rendered="#{!mainEntryForm.neu and !mainEntryForm.bearbeiten}"
			actionListener="#{mainEntryForm.doEdit}" />
		<tc:button label="#{appMsg.cancel}" action="#{mainEntryForm.doCancel}" />
		<tc:button label="Test" actionListener="#{mainEntryForm.test}" />
	</ui:define>

</ui:composition>

<!--

				rendered="#{mainEntryForm.checkListFilled}"


 -->
